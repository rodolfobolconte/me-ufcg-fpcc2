"0","#CALCULO DE THETA"
"0","theta <- function(dataset, indices, tipo1, tipo2) {"
"0","    agrupado = dataset %>% "
"0","        slice(indices) %>% "
"0","        group_by(scenario) %>% "
"0","        summarise(media = mean(satisfaction))"
"0","    b = agrupado %>% filter(scenario == tipo1) %>%"
"0","        pull(media)"
"0","    l = agrupado %>% filter(scenario == tipo2) %>%"
"0","        pull(media)"
"0","    b-l"
"0","}"
"0",""
"0","#FUNÇÃO QUE DIVIDE CONJUNTO DE DADOS E CALCULA THETA"
"0","comparacao = function(tipo1, tipo2) {"
"0","    comparacao_dados = dados %>% "
"0","        filter(scenario %in% c(tipo1, tipo2))"
"0","    "
"0","    set.seed(123)"
"0",""
"0","    #GERAÇÃO DO BOOTSTRAP    "
"0","    resultado_bootstrap = boot(data = comparacao_dados,"
"0","           statistic = theta,"
"0","           R = 2000,"
"0","           tipo1=tipo1,"
"0","           tipo2=tipo2) %>%"
"0","    tidy(conf.level = .95,"
"0","         conf.method = ""bca"","
"0","         conf.int = TRUE)"
"0","    "
"0","    resultado_bootstrap %>% "
"0","        mutate(variante_comparada=tipo2)"
"0","}"
